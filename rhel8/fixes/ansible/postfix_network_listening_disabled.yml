# platform = multi_platform_rhel,multi_platform_fedora,multi_platform_ol
# reboot = false
# strategy = restrict
# complexity = low
# disruption = low
- (xccdf-var var_postfix_inet_interfaces)

- name: Ensure mail transfer agent is configured for local-only mode
  lineinfile:
    path: /etc/postfix/main.cf
    create: false
    regexp: ^inet_interfaces\s*=\s.*
    line: inet_interfaces = {{ var_postfix_inet_interfaces }}
    state: present
    insertafter: ^inet_interfaces\s*=\s.*
  when: ansible_virtualization_role != "guest" or ansible_virtualization_type != "docker"
  tags:
    - postfix_network_listening_disabled
    - medium_severity
    - restrict_strategy
    - low_complexity
    - low_disruption
    - no_reboot_needed
    - CCE-82174-4
    - NIST-800-53-CM-7
