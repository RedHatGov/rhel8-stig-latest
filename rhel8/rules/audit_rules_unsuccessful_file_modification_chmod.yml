description: 'The audit system should collect unsuccessful file permission change

  attempts for all users and root.

  If the <tt>auditd</tt> daemon is configured

  to use the <tt>augenrules</tt> program to read audit rules during daemon

  startup (the default), add the following lines to a file with suffix

  <tt>.rules</tt> in the directory <tt>/etc/audit/rules.d</tt>.

  If the <tt>auditd</tt> daemon is configured to use the <tt>auditctl</tt>

  utility to read audit rules during daemon startup, add the following lines to

  <tt>/etc/audit/audit.rules</tt> file.

  <pre>-a always,exit -F arch=b32 -S chmod -F exit=-EACCES -F auid>=1000 -F auid!=unset
  -F key=unsuccesful-perm-change

  -a always,exit -F arch=b32 -S chmod -F exit=-EPERM -F auid>=1000 -F auid!=unset
  -F key=unsuccesful-perm-change</pre>

  If the system is 64 bit then also add the following lines:

  <pre>-a always,exit -F arch=b64 -S chmod -F exit=-EACCES -F auid>=1000 -F auid!=unset
  -F key=unsuccesful-perm-change

  -a always,exit -F arch=b64 -S chmod -F exit=-EPERM -F auid>=1000 -F auid!=unset
  -F key=unsuccesful-perm-change</pre>'
identifiers: {cce: 80975-6}
ocil: 'To determine if the system is configured to audit calls to the

  <code>chmod</code> system call, run the following command:

  <pre space="preserve">$ sudo grep "chmod" /etc/audit/audit.*</pre>

  If the system is configured to audit this activity, it will return a line.

  '
ocil_clause: no line is returned
oval_external_content: null
platform: machine
prodtype: rhel6,rhel7,rhel8,fedora,ol7,ol8,ocp4
rationale: 'Unsuccessful attempts to change permissions of files could be an indicator
  of malicious activity on a system. Auditing

  these events could serve as evidence of potential system compromise.'
references: {disa: '172', nist: AU-12(c), vmmsrg: 'SRG-OS-000458-VMM-001810,SRG-OS-000461-VMM-001830'}
severity: medium
template:
  backends: {}
  name: audit_rules_unsuccessful_file_modification
  vars: {name: chmod}
title: Record Unsuccessul Permission Changes to Files - chmod
warnings:
- {general: 'Note that these rules can be configured in a

    number of ways while still achieving the desired effect. Here the audit rule checks
    a

    system call independently of other system calls. Grouping system calls related

    to the same event is more efficient. See the following example:

    <pre>-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr
    -F exit=-EACCES -F auid>=1000 -F auid!=unset -F key=unsuccesful-perm-change</pre>'}
